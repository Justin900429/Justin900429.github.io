<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">

    

    <!-- 渲染优化 -->
    <meta name="renderer" content="webkit">
    <meta name="force-rendering" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="HandheldFriendly" content="True" >
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!--icon-->

    <link rel="shortcut icon" type='image/x-icon' href="/mylogo.ico">


    <!-- meta -->


<title>Binary exponentonentiation | Justin</title><meta name="robots" content="noindex">





    <!-- OpenGraph -->
 
    <meta name="description" content="Binary exponentonentiationSee moreBack to the series page   IntroductionIn this article, we’ll going to find out what is binary exponentiation and the advantage of using binary exponentiation. After r">
<meta property="og:type" content="article">
<meta property="og:title" content="Binary exponentonentiation">
<meta property="og:url" content="http://yoursite.com/2020/10/21/ds_and_algo/bin-exp/index.html">
<meta property="og:site_name" content="Justin">
<meta property="og:description" content="Binary exponentonentiationSee moreBack to the series page   IntroductionIn this article, we’ll going to find out what is binary exponentiation and the advantage of using binary exponentiation. After r">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-10-21T07:35:25.000Z">
<meta property="article:modified_time" content="2020-10-22T06:58:04.905Z">
<meta property="article:author" content="Justin Ruan">
<meta name="twitter:card" content="summary_large_image">


    
<link rel="stylesheet" href="/css/style/main.css">
 



    
    
    
        <link rel="stylesheet" id="hl-default-theme" href="https://cdn.jsdelivr.net/npm/highlight.js@10.1.2/styles/atom-one-light.min.css" media="none" onload="if(getComputedStyle(document.documentElement).getPropertyValue('--color-mode').indexOf('dark')===-1)this.media='all'">
        
    

    

    
    <link rel="stylesheet" href="/css/style/note.css" media="none" onload="this.media='all'">


     

    <!-- custom head -->

<meta name="generator" content="Hexo 5.1.1"></head>

    <body>
        <div id="app">
            <header class="header">
    <div class="header__left">
        <a href="/" class="button">
            <span class="logo__text">
                Justin's blog
            </span>
        </a>
    </div>
    <div class="header__right">
        
            <div class="navbar__menus">
                
                    <a href="/about/" class="navbar-menu button">
                        Home
                    </a>
                
                    <a href="/" class="navbar-menu button">
                        Articles
                    </a>
                
                    <a href="/tags/" class="navbar-menu button">
                        Tags
                    </a>
                
                    <a href="/archives/" class="navbar-menu button">
                        Archives
                    </a>
                
            </div>
        
        
        
    <a href="/search/" id="btn-search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" width="24" height="24" fill="currentColor" stroke="currentColor" stroke-width="32"><path d="M192 448c0-141.152 114.848-256 256-256s256 114.848 256 256-114.848 256-256 256-256-114.848-256-256z m710.624 409.376l-206.88-206.88A318.784 318.784 0 0 0 768 448c0-176.736-143.264-320-320-320S128 271.264 128 448s143.264 320 320 320a318.784 318.784 0 0 0 202.496-72.256l206.88 206.88 45.248-45.248z"></path></svg>
    </a>


        
        

         
    <a href="javaScript:void(0);" id="b2t" aria-label="Back to Top" title="Back to Top">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='32' height='32' fill="currentColor" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round">
            <path d="M13.889,11.611c-0.17,0.17-0.443,0.17-0.612,0l-3.189-3.187l-3.363,3.36c-0.171,0.171-0.441,0.171-0.612,0c-0.172-0.169-0.172-0.443,0-0.611l3.667-3.669c0.17-0.17,0.445-0.172,0.614,0l3.496,3.493C14.058,11.167,14.061,11.443,13.889,11.611 M18.25,10c0,4.558-3.693,8.25-8.25,8.25c-4.557,0-8.25-3.692-8.25-8.25c0-4.557,3.693-8.25,8.25-8.25C14.557,1.75,18.25,5.443,18.25,10 M17.383,10c0-4.07-3.312-7.382-7.383-7.382S2.618,5.93,2.618,10S5.93,17.381,10,17.381S17.383,14.07,17.383,10"></path>
        </svg>
    </a>


        
            <a class="dropdown-icon button" id="btn-dropdown">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='24' height='24' fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round">
                    <path fill="currentColor" d="M3.314,4.8h13.372c0.41,0,0.743-0.333,0.743-0.743c0-0.41-0.333-0.743-0.743-0.743H3.314c-0.41,0-0.743,0.333-0.743,0.743C2.571,4.467,2.904,4.8,3.314,4.8z M16.686,15.2H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,15.2,16.686,15.2z M16.686,9.257H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,9.257,16.686,9.257z"></path>
                </svg>
            </a>
            <div class="dropdown-menus" id="dropdown-menus">
                <a class="dropback-icon button" id="btn-dropback">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='24' height='24' fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round">
                        <path fill="currentColor" d="M11.469,10l7.08-7.08c0.406-0.406,0.406-1.064,0-1.469c-0.406-0.406-1.063-0.406-1.469,0L10,8.53l-7.081-7.08c-0.406-0.406-1.064-0.406-1.469,0c-0.406,0.406-0.406,1.063,0,1.469L8.531,10L1.45,17.081c-0.406,0.406-0.406,1.064,0,1.469c0.203,0.203,0.469,0.304,0.735,0.304c0.266,0,0.531-0.101,0.735-0.304L10,11.469l7.08,7.081c0.203,0.203,0.469,0.304,0.735,0.304c0.267,0,0.532-0.101,0.735-0.304c0.406-0.406,0.406-1.064,0-1.469L11.469,10z"></path>
                    </svg>
                </a>
                
                    <a href="/about/" class="dropdown-menu button">
                        Home
                    </a>
                
                    <a href="/" class="dropdown-menu button">
                        Articles
                    </a>
                
                    <a href="/tags/" class="dropdown-menu button">
                        Tags
                    </a>
                
                    <a href="/archives/" class="dropdown-menu button">
                        Archives
                    </a>
                
            </div>
            <script>
                document.getElementById('btn-dropdown').addEventListener('click', () => {
                    const dd = document.getElementById('dropdown-menus');
                    requestAnimationFrame(() => {
                        dd.style.display = 'flex';
                        requestAnimationFrame(() => {
                            dd.style.transform = 'translateY(0)';
                            dd.style.opacity = '1';
                        });
                    });
                });
                document.getElementById('btn-dropback').addEventListener('click', () => {
                    const dd = document.getElementById('dropdown-menus');
                    dd.style.transform = 'translateY(2.25rem)';                    
                    dd.style.opacity = '0';
                    setTimeout(() => {dd.style.display = 'none';}, 350);
                });
            </script>
        
    </div>
</header>


            <main class="main">
    
<div class="post-title">
    <h1 class="post-title__text">
        Binary exponentonentiation
    </h1>
    <div class="post-title__meta">
        <a href="/archives/2020/10/" class="post-meta__date button">
    2020-10-21
</a>
        
 
        
    
    


 

 
    </div>
</div>


    <div class="post__with-side">
        <aside class="post-side">
            <div class="post-side__toc">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Finding-the-pow"><span class="toc-number">2.</span> <span class="toc-text">Finding the pow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis"><span class="toc-number">3.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Idea-for-faster-approach"><span class="toc-number">4.</span> <span class="toc-text">Idea for faster approach</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Piece-by-piece"><span class="toc-number">5.</span> <span class="toc-text">Piece by piece</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-of-binary-exponentiation"><span class="toc-number">6.</span> <span class="toc-text">Analysis of binary exponentiation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fast-computing-the-modulo-of-large-exponent"><span class="toc-number">7.</span> <span class="toc-text">Fast computing the modulo of large exponent</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">8.</span> <span class="toc-text">References</span></a></li></ol>
            </div>
        </aside>
        <article class="post content-card">
            <div class="post__header"></div>
            <div class="post__content">
                <h1 id="Binary-exponentonentiation"><a href="#Binary-exponentonentiation" class="headerlink" title="Binary exponentonentiation"></a>Binary exponentonentiation</h1><blockquote class="blockquote-note blockquote-note__tip"><div class="blockquote-note__header"><div class="blockquote-note__icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>See more</div><div class="blockquote-note__content"><p><a href="/2020/10/10/ds_and_algo/dsa/">Back to the series page</a></p>
</div></blockquote>

<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In this article, we’ll going to find out what is binary exponentiation and the advantage of using binary exponentiation.</p>
<blockquote class="blockquote-note blockquote-note__important"><div class="blockquote-note__header"><div class="blockquote-note__icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>After reading, you'll learn：</div><div class="blockquote-note__content"><ol>
<li>Difference between the original method and binary exponentonentiation.</li>
<li>Conecpt behind the binary exponentiation and how to implement it.</li>
<li>Fast computing modulo of the large exponent.</li>
</ol>
</div></blockquote>

<h2 id="Finding-the-pow"><a href="#Finding-the-pow" class="headerlink" title="Finding the pow"></a>Finding the pow</h2><p>In normal event, we’ll use a loop or recursive function to implement the pow function. The idea is show below, let’s use $9^6$ to do the example.</p>
<p>$$<br>9^6 = \underbrace{9 * 9 * \cdots *9}_{6}<br>$$</p>
<p>Therefore, we can easily implement the code below:</p>
<pre><code class="hljs cpp"><span class="hljs-comment">/*</span>
<span class="hljs-comment"> Function for finding base^exponent in iterative way</span>
<span class="hljs-comment"> */</span>
<span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> <span class="hljs-title">pow</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> base, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> exponent)</span> </span>&#123;
    <span class="hljs-comment">// Create a result</span>
    <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> res = <span class="hljs-number">1</span>;
    
    <span class="hljs-comment">// Mutiply it exponent times</span>
    <span class="hljs-keyword">while</span> (exponent--) &#123;
        res *= base;
    &#125;
    
    <span class="hljs-comment">// Return result</span>
    <span class="hljs-keyword">return</span> res;
&#125;</code></pre>

<p>or in the recursive way</p>
<pre><code class="hljs cpp"><span class="hljs-comment">/*</span>
<span class="hljs-comment"> Function for finding base^exponent in recursive way</span>
<span class="hljs-comment"> */</span>
<span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> <span class="hljs-title">pow_rec</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> base, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> exponent)</span> </span>&#123;
    <span class="hljs-comment">// Terminatoin condition</span>
    <span class="hljs-keyword">if</span> (exponent == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    
    <span class="hljs-comment">// Return base * base^(exponent - 1)</span>
    <span class="hljs-keyword">return</span> pow_rec(base, exponent - <span class="hljs-number">1</span>) * base;
&#125;</code></pre>

<h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><p>The codes above use the same time complexity. However, both of them reach the complexity $O(n)$. That means, if we want to compute $n^{10000}$, we have to multiply it for $10000$ times. </p>
<p>On the other hand, if we can find another approach to reach $O(\log_2 n)$, then in the same case, we only need $log_2 100000$ times to get the result which is approximate to $17$ times.</p>
<h2 id="Idea-for-faster-approach"><a href="#Idea-for-faster-approach" class="headerlink" title="Idea for faster approach"></a>Idea for faster approach</h2><p>From above analysis, we know that the most important part is the exponent. Therefore, if we can find a way to <strong>break the exponent into seperate part</strong> and then multiply it at the end, we can compute it more efficiently.</p>
<p><mark>One way we can choose is to look the binary form of the exponent.</mark> For example, we know that 15 can be changed to $1111_2$ in binary world which implies that 15 can be broken into 4 parts.</p>
<p>We know that $1111_2$ means that $15 = 1 * 2^3 + 1 * 2^2 + 1 * 2^1 + 1 * 2^0$. Now let’s compute $9^{15}$, we know that 15 can be brought into:<br>$$<br>15 = 1 * 2^3 + 1 * 2^2 + 1 * 2^1 + 1 * 2^0<br>$$</p>
<p>which we can rewrite:<br>$$<br>9^{15} = 9^{1 * 2^3 + 1 * 2^2 + 1 * 2^1 + 1 * 2^0}<br>$$</p>
<p>According to the <a target="_blank" rel="noopener" href="https://www.mathsisfun.com/algebra/exponent-laws.html"><strong>exponential law</strong></a>, we know that $\forall a \geq 0, b, c \in R$:<br>$$<br>a^{b+c} = a^b * a^c<br>$$</p>
<p>Therefore, we can seperate $9^{15}$ into:</p>
<p>$$<br>\begin{align}<br>&amp;9^{1 * 2^3} * 9^{1 * 2^2} * 9^{1 * 2^1} * 9^{1 * 2^0} \\<br>= \ &amp;9^{8} * 9^4 * 9^2 * 9^1<br>\end{align}<br>$$</p>
<p>Notice here, that we make a huge progress in finding the exponentiation! We recognize that:</p>
<p>$$<br>\begin{align}<br>&amp;9^2 = (9^1)^2 \\<br>&amp;9^4 = (9^2)^2 \\<br>&amp;9^8 = (9^4)^2<br>\end{align}<br>$$</p>
<p>Therefore, instead of multiplying the number one by one, we can first compute the number and square it!</p>
<p>Let’s see another example for $9^{11}$. We know that $11$ can be written into $1011_2$, we mean:</p>
<p>$$<br>\begin{align}<br>9^{11} &amp;= 9^{1 * 2^3 + 0 * 2^2 + 1 * 2^1 + 1 * 2^0} \\<br>&amp;= 9^{1 * 2^3} * 9^{0 * 2^2} * 9^{1 * 2^1} * 9^{1 * 2^0} \\<br>&amp;= 9^{1 * 2^3} * 1 * 9^{1 * 2^1} * 9^{1 * 2^0} \\<br>&amp;= 9^8 * 1 * 9^2 * 9^1<br>\end{align}<br>$$</p>
<p>This time, we have a 1 in our equation, this is becaue there was a $0$ occurred third from the right of our binary format.</p>
<p>However, when we want to devide $11$ by $2$ in <strong>C++</strong>, we’ll get 5 instead. This we’ll cause the wrong result. Hence, we should regard $9^{11}$ as $9^{10} * 9$ and compute $9^{10}$.</p>
<h2 id="Piece-by-piece"><a href="#Piece-by-piece" class="headerlink" title="Piece by piece"></a>Piece by piece</h2><p>First, let’s think about how can we start. To compute $9^10$, we should compute $9^5$. Also, to compute $9^5$, we should compute $9^2$. Therefore, we can form a recursive function.</p>
<p>$$<br>a^n =<br>\begin{cases}<br>1, &amp; \text{if n == 0} \\<br>(a^{\frac{n}{2}}) ^2 &amp; \text{if n is even} \\<br>(a^{\frac{n-1}{2}})^2*a &amp; \text{if n is odd} \\<br>\end{cases}<br>$$</p>
<pre><code class="hljs cpp"><span class="hljs-comment">/*</span>
<span class="hljs-comment"> Function for using bin pow in recursive way</span>
<span class="hljs-comment"> */</span>
<span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> <span class="hljs-title">bin_pow</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> base, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> exponent)</span> </span>&#123;
    <span class="hljs-comment">// terminate condition</span>
    <span class="hljs-keyword">if</span> (exponent == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    
    <span class="hljs-comment">// count the base^(exponent/2)</span>
    <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> res = binpow(base, exponent / <span class="hljs-number">2</span>);
    
    <span class="hljs-comment">// If even, square it</span>
    <span class="hljs-keyword">if</span> (exponent % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) &#123;
        <span class="hljs-keyword">return</span> res * res;
    &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// otherwise, square it and multiply the base</span>
        <span class="hljs-keyword">return</span> res * res * base;
    &#125;
&#125;</code></pre>

<p>Also, we can program it in iterative way:</p>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> <span class="hljs-title">binpow</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> base, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> exponent)</span> </span>&#123;
    <span class="hljs-comment">// Initialize the result</span>
    <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> res = <span class="hljs-number">1</span>;
    
    <span class="hljs-comment">// Find the exponentonent</span>
    <span class="hljs-keyword">while</span> (exponent) &#123; <span class="hljs-comment">// if exponent is not 0</span>
        <span class="hljs-comment">// Check whether place is 0 or not</span>
        <span class="hljs-keyword">if</span> (exponent &amp; <span class="hljs-number">1</span>)
            res = res *= base;
            
        <span class="hljs-comment">// Count the square of the base</span>
        base *= base;
        
        <span class="hljs-comment">// devide exponent by 2, which is same as exponent /= 2</span>
        exponent &gt;&gt;= <span class="hljs-number">1</span>;
    &#125;
    
    <span class="hljs-comment">// Return result</span>
    <span class="hljs-keyword">return</span> res;
&#125;</code></pre>

<h2 id="Analysis-of-binary-exponentiation"><a href="#Analysis-of-binary-exponentiation" class="headerlink" title="Analysis of binary exponentiation"></a>Analysis of binary exponentiation</h2><p>We have just mentioned that the important part of the time complexity is the exponent. In the binary exponentiation, the most important idea is to devide the exponent by 2. Therefore, the time complexity is $O(\log _2n)$.</p>
<pre><code class="hljs cpp">...
<span class="hljs-comment">// devide exp by2</span>
<span class="hljs-built_in">exp</span> &gt;&gt;= <span class="hljs-number">1</span>
...</code></pre>

<pre><code class="hljs cpp">...
<span class="hljs-comment">// count the base^(exp/2)</span>
<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> res = binpow(base, <span class="hljs-built_in">exp</span> / <span class="hljs-number">2</span>);
...</code></pre>

<h2 id="Fast-computing-the-modulo-of-large-exponent"><a href="#Fast-computing-the-modulo-of-large-exponent" class="headerlink" title="Fast computing the modulo of large exponent"></a>Fast computing the modulo of large exponent</h2><p>One thing we may encounter in programming (such as Miller Robin primality tests) is to compute:</p>
<p>$$<br>a^p \ mod \ k<br>$$</p>
<p>However, we know that </p>
<p>$$<br>a * b \equiv (a \ mod \ k) * (b \ mod \ k)  \  \ \ \ \ (mod \ k)<br>$$</p>
<p>Therefore, to compute  $a^p \ mod \ k$, we don’t have to wait for finishing compute $a^p$, instead, we can compute it by modulo every number after we multiply.</p>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> <span class="hljs-title">bin_pow_mod</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> base,</span></span>
<span class="hljs-function"><span class="hljs-params">                          <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> exponent,</span></span>
<span class="hljs-function"><span class="hljs-params">                          <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> mod)</span> </span>&#123;
    <span class="hljs-comment">// Initialize the result</span>
    <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> res = <span class="hljs-number">1</span>;
    
    <span class="hljs-comment">// Find the exponentonent</span>
    <span class="hljs-keyword">while</span> (exponent) &#123; <span class="hljs-comment">// if exponent is not 0</span>
        <span class="hljs-comment">// Check whether place is 0 or not</span>
        <span class="hljs-keyword">if</span> (exponent &amp; <span class="hljs-number">1</span>)
            <span class="hljs-comment">// Compute res and mod it</span>
            res = (res * base) % mod;
            
        <span class="hljs-comment">// Count the square of the base</span>
        <span class="hljs-comment">// and mod it first</span>
        base = (base * base) % mod;
        
        <span class="hljs-comment">// devide exponent by 2, which is same as exponent /= 2</span>
        exponent &gt;&gt;= <span class="hljs-number">1</span>;
    &#125;
    
    <span class="hljs-comment">// Return result</span>
    <span class="hljs-keyword">return</span> res;                          
&#125;</code></pre>



<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://cp-algorithms.com/algebra/binary-exp.html">Binary exponentiation</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/modular-exponentiation-power-in-modular-arithmetic/">Modular Exponentiation (Power in Modular Arithmetic)</a></li>
</ol>
<!-- flag of hidden posts -->
            </div>
             
            <div class="post-footer__meta">
    <p>
        updated at 2020-10-22
    </p>
</div> 
            <div class="post-meta__cats">
    
    
</div> 
        </article>
        
            <div class="post__comments content-card" id="comment">
                
    <h4>Comments</h4>
    
    <div id="disqus_thread">Unable to load Disqus, please make sure your network can access.</div>

    
    
    
    
    
    
    
    


            </div>
        
    </div>


</main>

            <footer class="footer">
    
        <script src='https://cdnjs.cloudflare.com/ajax/libs/viz.js/1.7.1/viz.js'></script>
        <script>
          String.prototype.replaceAll = function(search, replacement) {
            var target = this;
            return target.split(search).join(replacement);
          };
      
          let vizObjects = document.querySelectorAll('.graphviz')
      
          for (let item of vizObjects) {
            let svg = undefined
            try {
              svg = Viz(item.textContent.replaceAll('–', '--'), 'svg')
            } catch(e) {
              svg = `<pre class="error">${e}</pre>`
            }
            item.outerHTML = svg
          }
        </script>
    
    


    
     
 

 
    
        
        <p class="footer-copyright">
            Copyright&nbsp;©&nbsp;2020&nbsp;<a href="/">Justin</a>
        </p>
    
    
    <p>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme - <a href="https://github.com/ChrAlpha/hexo-theme-cards" target="_blank">Cards</a></p>
</footer>

        </div>
        
    <script defer src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.1.0/dist/lazyload.min.js"></script>
    <script>
        window.lazyLoadOptions = {
            elements_selector: ".lazyload",
            threshold: 0
        };
    </script>
 

 

 

 

  



 


    


 

 
    <script defer src="/js/b2t.js"></script>



    <script>
        if (typeof MathJax === 'undefined') {
            window.MathJax = {
                loader: {
                    source: {
                        '[tex]/amsCd': '[tex]/amscd',
                        '[tex]/AMScd': '[tex]/amscd'
                    }
                },
                tex: {
                    inlineMath: [['$', '$'], ['\\(', '\\)']],
                },
                options: {
                    renderActions: {
                        findScript: [10, doc => {
                            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                                const display = !!node.type.match(/; *mode=display/);
                                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                                const text = document.createTextNode('');
                                node.parentNode.replaceChild(text, node);
                                math.start = {node: text, delim: '', n: 0};
                                math.end = {node: text, delim: '', n: 0};
                                doc.math.push(math);
                            });
                        }, '', false],
                        insertedScript: [200, () => {
                            document.querySelectorAll('mjx-container').forEach(node => {
                                let target = node.parentNode;
                                if (target.nodeName.toLowerCase() === 'li') {
                                    target.parentNode.classList.add('has-jax');
                                }
                            });
                        }, '', false]
                    }
                }
            };
            (function () {
                var script = document.createElement('script');
                script.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
                script.defer = true;
                document.head.appendChild(script);
            })();
        } else {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
        }
    </script>



    
    <script>
        function loadComment() {
            window.disqus_config = function () {
                this.page.url = 'http://yoursite.com/2020/10/21/ds_and_algo/bin-exp/';
                this.page.identifier = '2020/10/21/ds_and_algo/bin-exp/';
            };
            (function(){
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + 'https-justin900429-github-io' + '.disqus.com/embed.js';
                (document.head || document.body).appendChild(dsq);
            })();
        }
    
        var runningOnBrowser = typeof window !== "undefined";
        var isBot = runningOnBrowser && !("onscroll" in window) || typeof navigator !== "undefined" && /(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);
        var supportsIntersectionObserver = runningOnBrowser && "IntersectionObserver" in window;
    
        setTimeout(function () {
            if (!isBot && supportsIntersectionObserver) {
                var comment_observer = new IntersectionObserver(function(entries) {
                    if (entries[0].isIntersecting) {
                        loadComment();
                        comment_observer.disconnect();
                    }
                }, { threshold: [0] });
                comment_observer.observe(document.getElementById('comment'));
            } else {
                loadComment();
            }
        }, 1);
    </script>


    
    
    

    
    
    
    
    
    
    
    
    

    



    </body>
</html>
