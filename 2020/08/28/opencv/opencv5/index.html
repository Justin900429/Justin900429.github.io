<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">

    

    <!-- 渲染优化 -->
    <meta name="renderer" content="webkit">
    <meta name="force-rendering" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="HandheldFriendly" content="True" >
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!--icon-->

    <link rel="shortcut icon" type='image/x-icon' href="/favicon.ico">


    <!-- meta -->


<title>opencv5 | Justin</title><meta name="robots" content="noindex">





    <!-- OpenGraph -->
 
    <meta name="description" content="OpenCV with Python – 5Content README OpenCV with Python – 1 OpenCV with Python – 2 OpenCV with Python – 3 OpenCV with Python – 4 OpenCV with Python – 5  IntroductionWe often come across the problem th">
<meta property="og:type" content="article">
<meta property="og:title" content="opencv5">
<meta property="og:url" content="http://yoursite.com/2020/08/28/opencv/opencv5/index.html">
<meta property="og:site_name" content="Justin">
<meta property="og:description" content="OpenCV with Python – 5Content README OpenCV with Python – 1 OpenCV with Python – 2 OpenCV with Python – 3 OpenCV with Python – 4 OpenCV with Python – 5  IntroductionWe often come across the problem th">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.imgur.com/SbPHgvl.png">
<meta property="og:image" content="https://i.imgur.com/erbAJgX.jpg">
<meta property="og:image" content="https://i.imgur.com/1bFqp8w.jpg">
<meta property="og:image" content="https://i.imgur.com/9wDsJiX.jpg">
<meta property="article:published_time" content="2020-08-28T14:00:05.000Z">
<meta property="article:modified_time" content="2020-08-28T14:07:15.796Z">
<meta property="article:author" content="Justin Ruan">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.imgur.com/SbPHgvl.png">


    
<link rel="stylesheet" href="/css/style/main.css">
 


    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-cards@1.0/dist/css/style/dark.min.css">

    
<script src="https://cdn.jsdelivr.net/npm/hexo-theme-cards@1.0/dist/js/darkmode.min.js"></script>



    
    
    
        <link rel="stylesheet" id="hl-default-theme" href="https://cdn.jsdelivr.net/npm/highlight.js@10.1.2/styles/atom-one-light.min.css" media="none" onload="if(getComputedStyle(document.documentElement).getPropertyValue('--color-mode').indexOf('dark')===-1)this.media='all'">
        
            <link rel="stylesheet" id="hl-dark-theme" href="https://cdn.jsdelivr.net/npm/highlight.js@10.1.2/styles/railscasts.min.css" media="none" onload="if(getComputedStyle(document.documentElement).getPropertyValue('--color-mode').indexOf('dark')!==-1)this.media='all'">
        
    

    

    
    <link rel="stylesheet" href="/css/style/note.css" media="none" onload="this.media='all'">


     

    <!-- custom head -->

<meta name="generator" content="Hexo 5.1.1"></head>

    <body>
        <div id="app">
            <header class="header">
    <div class="header__left">
        <a href="/" class="button">
            <span class="logo__text">
                Justin's blog
            </span>
        </a>
    </div>
    <div class="header__right">
        
            <div class="navbar__menus">
                
                    <a href="/about/" class="navbar-menu button">
                        Home
                    </a>
                
                    <a href="/" class="navbar-menu button">
                        Articles
                    </a>
                
                    <a href="/tags/" class="navbar-menu button">
                        Tags
                    </a>
                
                    <a href="/archives/" class="navbar-menu button">
                        Archives
                    </a>
                
            </div>
        
        
        
    <a href="/search/" id="btn-search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" width="24" height="24" fill="currentColor" stroke="currentColor" stroke-width="32"><path d="M192 448c0-141.152 114.848-256 256-256s256 114.848 256 256-114.848 256-256 256-256-114.848-256-256z m710.624 409.376l-206.88-206.88A318.784 318.784 0 0 0 768 448c0-176.736-143.264-320-320-320S128 271.264 128 448s143.264 320 320 320a318.784 318.784 0 0 0 202.496-72.256l206.88 206.88 45.248-45.248z"></path></svg>
    </a>


        
        
    <a href="javaScript:void(0);" id="btn-toggle-dark">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
    </a>


         
    <a href="javaScript:void(0);" id="b2t" aria-label="Back to Top" title="Back to Top">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='32' height='32' fill="currentColor" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round">
            <path d="M13.889,11.611c-0.17,0.17-0.443,0.17-0.612,0l-3.189-3.187l-3.363,3.36c-0.171,0.171-0.441,0.171-0.612,0c-0.172-0.169-0.172-0.443,0-0.611l3.667-3.669c0.17-0.17,0.445-0.172,0.614,0l3.496,3.493C14.058,11.167,14.061,11.443,13.889,11.611 M18.25,10c0,4.558-3.693,8.25-8.25,8.25c-4.557,0-8.25-3.692-8.25-8.25c0-4.557,3.693-8.25,8.25-8.25C14.557,1.75,18.25,5.443,18.25,10 M17.383,10c0-4.07-3.312-7.382-7.383-7.382S2.618,5.93,2.618,10S5.93,17.381,10,17.381S17.383,14.07,17.383,10"></path>
        </svg>
    </a>


        
            <a class="dropdown-icon button" id="btn-dropdown">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='24' height='24' fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round">
                    <path fill="currentColor" d="M3.314,4.8h13.372c0.41,0,0.743-0.333,0.743-0.743c0-0.41-0.333-0.743-0.743-0.743H3.314c-0.41,0-0.743,0.333-0.743,0.743C2.571,4.467,2.904,4.8,3.314,4.8z M16.686,15.2H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,15.2,16.686,15.2z M16.686,9.257H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,9.257,16.686,9.257z"></path>
                </svg>
            </a>
            <div class="dropdown-menus" id="dropdown-menus">
                <a class="dropback-icon button" id="btn-dropback">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='24' height='24' fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round">
                        <path fill="currentColor" d="M11.469,10l7.08-7.08c0.406-0.406,0.406-1.064,0-1.469c-0.406-0.406-1.063-0.406-1.469,0L10,8.53l-7.081-7.08c-0.406-0.406-1.064-0.406-1.469,0c-0.406,0.406-0.406,1.063,0,1.469L8.531,10L1.45,17.081c-0.406,0.406-0.406,1.064,0,1.469c0.203,0.203,0.469,0.304,0.735,0.304c0.266,0,0.531-0.101,0.735-0.304L10,11.469l7.08,7.081c0.203,0.203,0.469,0.304,0.735,0.304c0.267,0,0.532-0.101,0.735-0.304c0.406-0.406,0.406-1.064,0-1.469L11.469,10z"></path>
                    </svg>
                </a>
                
                    <a href="/about/" class="dropdown-menu button">
                        Home
                    </a>
                
                    <a href="/" class="dropdown-menu button">
                        Articles
                    </a>
                
                    <a href="/tags/" class="dropdown-menu button">
                        Tags
                    </a>
                
                    <a href="/archives/" class="dropdown-menu button">
                        Archives
                    </a>
                
            </div>
            <script>
                document.getElementById('btn-dropdown').addEventListener('click', () => {
                    const dd = document.getElementById('dropdown-menus');
                    requestAnimationFrame(() => {
                        dd.style.display = 'flex';
                        requestAnimationFrame(() => {
                            dd.style.transform = 'translateY(0)';
                            dd.style.opacity = '1';
                        });
                    });
                });
                document.getElementById('btn-dropback').addEventListener('click', () => {
                    const dd = document.getElementById('dropdown-menus');
                    dd.style.transform = 'translateY(2.25rem)';                    
                    dd.style.opacity = '0';
                    setTimeout(() => {dd.style.display = 'none';}, 350);
                });
            </script>
        
    </div>
</header>


            <main class="main">
    
<div class="post-title">
    <h1 class="post-title__text">
        opencv5
    </h1>
    <div class="post-title__meta">
        <a href="/archives/2020/08/" class="post-meta__date button">
    2020-08-28
</a>
        
 
        
    
    


 

 
    </div>
</div>


    <div class="post__with-side">
        <aside class="post-side">
            <div class="post-side__toc">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Content"><span class="toc-number">1.</span> <span class="toc-text">Content</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">2.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Color-detection"><span class="toc-number">3.</span> <span class="toc-text">Color detection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows"><span class="toc-number">3.1.</span> <span class="toc-text">Windows</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Trackbars"><span class="toc-number">3.2.</span> <span class="toc-text">Trackbars</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mask"><span class="toc-number">3.3.</span> <span class="toc-text">Mask</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bitwise-and"><span class="toc-number">3.4.</span> <span class="toc-text">Bitwise and</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pack-it-all-together"><span class="toc-number">3.5.</span> <span class="toc-text">Pack it all together!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cascade-classifier"><span class="toc-number">4.</span> <span class="toc-text">Cascade classifier</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Summary"><span class="toc-number">5.</span> <span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">6.</span> <span class="toc-text">Reference</span></a></li></ol>
            </div>
        </aside>
        <article class="post content-card">
            <div class="post__header"></div>
            <div class="post__content">
                <h1 id="OpenCV-with-Python-–-5"><a href="#OpenCV-with-Python-–-5" class="headerlink" title="OpenCV with Python – 5"></a>OpenCV with Python – 5</h1><h2 id="Content"><a href="#Content" class="headerlink" title="Content"></a>Content</h2><ul>
<li><a href="/2020/08/28/opencv/README/">README</a></li>
<li><a href="/2020/08/27/opencv/opencv1">OpenCV with Python – 1</a></li>
<li><a href="/2020/08/28/opencv/opencv2">OpenCV with Python – 2</a></li>
<li><a href="/2020/08/28/opencv/opencv3">OpenCV with Python – 3</a></li>
<li><a href="/2020/08/28/opencv/opencv4">OpenCV with Python – 4</a></li>
<li><a href="/2020/08/28/opencv/opencv5">OpenCV with Python – 5</a></li>
</ul>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>We often come across the problem that we only want the robot to see the specific color. In fact, this help robot only to analyze the wanted info. To achieve the result, we will learn how to do the color detection and how to add trackbar to tune the parameter in image windows.</p>
<h2 id="Color-detection"><a href="#Color-detection" class="headerlink" title="Color detection"></a>Color detection</h2><p>In normal event, we will use <strong>HSV</strong> format to do the color detection. Therefore, we have try different value to certain that we can remove unwanted color and leave the target. To achieve the filtering, we will first use <strong>trackbar</strong> to find the values.</p>
<h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>To add the trackbar, we have to create a new window for trackbar. The syntax is as follows:</p>
<ul>
<li><code>cv2.namedWindow(name, flags)</code>  <ul>
<li>name: Window’s name.  </li>
<li>flags: Flags of the window. See the <a target="_blank" rel="noopener" href="https://docs.opencv.org/2.4/modules/highgui/doc/user_interface.html?highlight=namedwindow#namedwindow">documentation</a> for more detail.</li>
</ul>
</li>
</ul>
<ul>
<li><code>cv2.resizeWindow(name, width, height)</code>  <ul>
<li>name: The name of the window to be resized. </li>
<li>width: Width after resize.  </li>
<li>height: Height after resize.  </li>
</ul>
</li>
</ul>
<pre><code class="hljs python"><span class="hljs-comment"># Create window and make window resizable.</span>
cv2.namedWindow(<span class="hljs-string">&quot;TrackBars&quot;</span>, cv2.WINDOW_NORMAL)

<span class="hljs-comment"># Resize the window</span>
cv2.resizeWindow(<span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">100</span>)</code></pre>

<h3 id="Trackbars"><a href="#Trackbars" class="headerlink" title="Trackbars"></a>Trackbars</h3><p>We shoule ensure that we can ==set and get the values==. Therefore, we alway have to implement two function for each trackbars.</p>
<ul>
<li><code>cv2.createTracker(trackbar_name, window_name, min_value, max_value, callback)</code>  <ul>
<li>trackbar_name: Name of the new trackbar.  </li>
<li>window_name: Window to add the trackbar.  </li>
<li>min_value: Minimum value of the trackbar. </li>
<li>max_value: Maximum value of the trackbar.  </li>
<li>callback: Function to be called when the value of trackbar has changed.  </li>
</ul>
</li>
</ul>
<ul>
<li><code>cv2.getTrackbarPos(trackbar_name, window_name)</code><br>  Get the result of the trackbar<ul>
<li>trackbar_name: The target trackbar’s name.  </li>
<li>window_name: Name of the window where the trackbar exists.  </li>
</ul>
</li>
</ul>
<pre><code class="hljs python"><span class="hljs-comment"># Create trackbar</span>
cv2.createTrackbar(<span class="hljs-string">&quot;Hue Min&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">179</span>, empty)

<span class="hljs-comment"># Get the trackbar value</span>
h_lower = cv2.getTrackbarPos(<span class="hljs-string">&quot;Hue Min&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>)</code></pre>

<hr>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np


<span class="hljs-comment"># Callback function</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">empty</span>(<span class="hljs-params">x</span>):</span>
    <span class="hljs-keyword">pass</span>


<span class="hljs-comment"># Create window</span>
cv2.namedWindow(<span class="hljs-string">&quot;TrackBars&quot;</span>, cv2.WINDOW_NORMAL)
cv2.resizeWindow(<span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">40</span>)

<span class="hljs-comment"># Create trackbar</span>
cv2.createTrackbar(<span class="hljs-string">&quot;Hue Min&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">179</span>, empty)
cv2.createTrackbar(<span class="hljs-string">&quot;Hue Max&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">179</span>, <span class="hljs-number">179</span>, empty)
cv2.createTrackbar(<span class="hljs-string">&quot;Sat Min&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>, empty)
cv2.createTrackbar(<span class="hljs-string">&quot;Sat Max&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, empty)
cv2.createTrackbar(<span class="hljs-string">&quot;Value Min&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>, empty)
cv2.createTrackbar(<span class="hljs-string">&quot;Value Max&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, empty)

cv2.waitKey(<span class="hljs-number">0</span>)
cv2.destroyAllWindows()
cv2.waitKey(<span class="hljs-number">1</span>)</code></pre>

<p>You will see: </br></p>
<p><img src="https://i.imgur.com/SbPHgvl.png" class="lazyload" data-srcset="https://i.imgur.com/SbPHgvl.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg=="></p>
<h3 id="Mask"><a href="#Mask" class="headerlink" title="Mask"></a>Mask</h3><p>To get the specifi range of hsv value, we can use mask to filter the value. If the value is outside the range, it will be set to 0 and 1 otherwise. To put it simply, mask help us to transform the image to binary format.</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-comment"># Convert image to HSV format</span>
img = cv2.imread(<span class="hljs-string">&quot;resources/car.jpg&quot;</span>)
img_hsv = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)

<span class="hljs-comment"># Using the mask to filter the color</span>
lower = np.array([<span class="hljs-number">0</span>, <span class="hljs-number">93</span>, <span class="hljs-number">0</span>])
upper = np.array([<span class="hljs-number">10</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>])
mask = cv2.inRange(img_hsv, lower, upper)

result = np.hstack([img, cv2.cvtColor(mask, cv2.COLOR_GRAY2BGR)])
cv2.imshow(<span class="hljs-string">&quot;Mask image&quot;</span>, result)

cv2.waitKey(<span class="hljs-number">0</span>)
cv2.destroyAllWindows()
cv2.waitKey(<span class="hljs-number">1</span>)</code></pre>
<center><img src=https://i.imgur.com/CkEshMW.jpg width=500/></center>
</br>


<h3 id="Bitwise-and"><a href="#Bitwise-and" class="headerlink" title="Bitwise and"></a>Bitwise and</h3><p>We expect to get the image in RGB format. Thus, we can use <code>cv2.bitwise_and</code> to get the result.</p>
<ul>
<li><p><code>cv2.bitwise_and(img1, img2)</code></p>
<p>  Perform bitwise operation between <strong>img1</strong> and <strong>img2</strong>.</p>
<ul>
<li>img1: First input array.  </li>
<li>img2: Second input array.  </li>
</ul>
</li>
</ul>
<pre><code class="hljs python"><span class="hljs-comment"># Result image</span>
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-comment"># Convert image to HSV format</span>
img = cv2.imread(<span class="hljs-string">&quot;resources/car.jpg&quot;</span>)
img_hsv = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)

<span class="hljs-comment"># Using the mask to filter the color</span>
lower = np.array([<span class="hljs-number">0</span>, <span class="hljs-number">93</span>, <span class="hljs-number">0</span>])
upper = np.array([<span class="hljs-number">10</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>])
mask = cv2.inRange(img_hsv, lower, upper)

<span class="hljs-comment"># Result image</span>
<span class="hljs-string">&#x27;&#x27;&#x27;</span>
<span class="hljs-string">Mask should have the same size of img.</span>
<span class="hljs-string">Then we should cv2.cvtColor() to convert mask to RGB</span>
<span class="hljs-string">but still remain binary format.</span>
<span class="hljs-string">&#x27;&#x27;&#x27;</span>
img_result = cv2.bitwise_and(img, cv2.cvtColor(mask, cv2.COLOR_GRAY2BGR))

result = np.hstack([img, cv2.cvtColor(mask, cv2.COLOR_GRAY2BGR), img_result])

cv2.imshow(<span class="hljs-string">&quot;Mask image&quot;</span>, result)

cv2.waitKey(<span class="hljs-number">0</span>)
cv2.destroyAllWindows()
cv2.waitKey(<span class="hljs-number">1</span>)</code></pre>
<p><img src="https://i.imgur.com/erbAJgX.jpg" class="lazyload" data-srcset="https://i.imgur.com/erbAJgX.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg=="></p>
<hr>
<h3 id="Pack-it-all-together"><a href="#Pack-it-all-together" class="headerlink" title="Pack it all together!"></a>Pack it all together!</h3><p>To filter the right color we want, we just have to use <code>while</code> to pack everything together. Hense, we can change the values and observe the results simultaneously.</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">empty</span>(<span class="hljs-params">x</span>):</span>
    <span class="hljs-keyword">pass</span>


<span class="hljs-comment"># Create window</span>
cv2.namedWindow(<span class="hljs-string">&quot;TrackBars&quot;</span>, cv2.WINDOW_NORMAL)
cv2.resizeWindow(<span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">100</span>)

<span class="hljs-comment"># Create trackbar</span>
cv2.createTrackbar(<span class="hljs-string">&quot;Hue Min&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">179</span>, empty)
cv2.createTrackbar(<span class="hljs-string">&quot;Hue Max&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">179</span>, <span class="hljs-number">179</span>, empty)
cv2.createTrackbar(<span class="hljs-string">&quot;Sat Min&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>, empty)
cv2.createTrackbar(<span class="hljs-string">&quot;Sat Max&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, empty)
cv2.createTrackbar(<span class="hljs-string">&quot;Value Min&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>, empty)
cv2.createTrackbar(<span class="hljs-string">&quot;Value Max&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, empty)

<span class="hljs-comment"># Convert image to HSV format</span>
img = cv2.imread(<span class="hljs-string">&quot;resources/car.jpg&quot;</span>)
img_hsv = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)
    
<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
    <span class="hljs-comment"># Get the trackbar value</span>
    h_lower = cv2.getTrackbarPos(<span class="hljs-string">&quot;Hue Min&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>)
    h_upper = cv2.getTrackbarPos(<span class="hljs-string">&quot;Hue Max&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>)
    s_lower = cv2.getTrackbarPos(<span class="hljs-string">&quot;Sat Min&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>)
    s_upper = cv2.getTrackbarPos(<span class="hljs-string">&quot;Sat Max&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>)
    v_lower = cv2.getTrackbarPos(<span class="hljs-string">&quot;Value Min&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>)
    v_upper = cv2.getTrackbarPos(<span class="hljs-string">&quot;Value Max&quot;</span>, <span class="hljs-string">&quot;TrackBars&quot;</span>)
    
    <span class="hljs-comment"># Using the mask to filter the color</span>
    lower = np.array([h_lower, s_lower, v_lower])
    upper = np.array([h_upper, s_upper, v_upper])
    mask = cv2.inRange(img_hsv, lower, upper)
    
    <span class="hljs-comment"># Result image</span>
    img_result = cv2.bitwise_and(img, img, mask=mask)
    
    <span class="hljs-comment"># Show the image</span>
    img_stack = stackImages(<span class="hljs-number">0.5</span>, [[img, img_hsv], [mask, img_result]])
    cv2.imshow(<span class="hljs-string">&quot;Image&quot;</span>, img_stack)
    
    <span class="hljs-keyword">if</span> cv2.waitKey(<span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFF</span> == ord(<span class="hljs-string">&#x27;q&#x27;</span>): 
        <span class="hljs-keyword">break</span>;
        
<span class="hljs-comment"># Print out the wanted range</span>
print(h_lower, s_lower, v_lower)
print(h_upper, s_upper, v_upper)

cv2.destroyAllWindows()
cv2.waitKey(<span class="hljs-number">1</span>)</code></pre>

<h2 id="Cascade-classifier"><a href="#Cascade-classifier" class="headerlink" title="Cascade classifier"></a>Cascade classifier</h2><p><strong>Cascade classifier</strong> is an object detection technique that used in <strong>OpenCV</strong>. You can learn more about it in this <a target="_blank" rel="noopener" href="http://www.willberger.org/cascade-haar-explained/">article</a> written by <strong>Will Berger</strong>. We’re only focus on how to use the <strong>OpenCV</strong> function to get the result on the pretrained model (You can use your model as well!). We’re going to download the pretrained model for face recognition.</p>
<p>The pretrained model is in <a target="_blank" rel="noopener" href="https://github.com/opencv/opencv/tree/master/data/haarcascades">this</a> github repo. We choose  <strong>haarcascade_frontalface_default.xml</strong> to do the demonstation. You should prepare a image with face in it!</p>
<ul>
<li><code>cv2.CascadeClassifier.detectMultiScale(img, scaleFactor, minNeighbors)</code> <a target="_blank" rel="noopener" href="https://docs.opencv.org/2.4/modules/objdetect/doc/cascade_classification.html#cascadeclassifier-detectmultiscale">Documentation</a>  <ul>
<li>img: Image to detect.</li>
<li>scaleFactor: Specifying how much the image size is reduced at each image scale.  </li>
<li>minNeighbors: Specifying how many neighbors each candidate rectangle should have to retain it.</li>
</ul>
</li>
</ul>
<p>The param <code>minNeighbor</code> is implict in the documentation. I stronly recommend to see <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/22249579/opencv-detectmultiscale-minneighbors-parameter">this</a> explanation from <strong>stack overflow</strong>.</p>
<p>The param <code>scalerFactor</code> help you to detect different shape of faces. Because the model have fixed size during training, therefore, we should resize the image to match the detection size to. If the value is <strong>1.05</strong>, it will decrease <strong>0.05%</strong> every iteration.<br><img src="https://i.imgur.com/1bFqp8w.jpg" class="lazyload" data-srcset="https://i.imgur.com/1bFqp8w.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg=="></p>
<p><strong>Demonstration</strong></p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-comment"># Read in the xml file</span>
face_cascade = cv2.CascadeClassifier(<span class="hljs-string">&quot;cascade_files/haarcascade_frontalface_default.xml&quot;</span>)

<span class="hljs-comment"># Read in the face image</span>
img = cv2.imread(<span class="hljs-string">&quot;resources/me.jpg&quot;</span>)

<span class="hljs-comment"># Convert into gray scale</span>
img_gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)

<span class="hljs-comment"># Dectect the face</span>
faces = face_cascade.detectMultiScale(img_gray, <span class="hljs-number">1.1</span>, <span class="hljs-number">4</span>)

<span class="hljs-comment"># Draw the bounding boxes</span>
<span class="hljs-keyword">for</span> (x, y, w, h) <span class="hljs-keyword">in</span> faces:
    cv2.rectangle(img, (x, y), (x + w, y + h), (<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>), <span class="hljs-number">2</span>)
    
cv2.imshow(<span class="hljs-string">&quot;Result&quot;</span>, img)

cv2.waitKey(<span class="hljs-number">0</span>)
cv2.destroyAllWindows()
cv2.waitKey(<span class="hljs-number">1</span>)</code></pre>
<center><img src="https://i.imgur.com/9wDsJiX.jpg" class="lazyload" data-srcset="https://i.imgur.com/9wDsJiX.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg==" width=450/></center>

<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>We have finished introducting the basic knowledge of image preprocessing and the use of <strong>OpenCV</strong>. From convolution, resizing, color detection and so on. I hope you guys can really learn a lot from the articles and use it in your next project! Thanks for reading and see you in next series!</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.bogotobogo.com/python/OpenCV_Python/python_opencv3_Image_Object_Detection_Face_Detection_Haar_Cascade_Classifiers.php">OBJECT DETECTION : FACE DETECTION USING HAAR CASCADE CLASSFIERS</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/22249579/opencv-detectmultiscale-minneighbors-parameter">OpenCV detectMultiScale() minNeighbors parameter</a></li>
</ol>
<!-- flag of hidden posts -->
            </div>
             
            <div class="post-footer__meta">
    <p>
        updated at 2020-08-28
    </p>
</div> 
            <div class="post-meta__cats">
    
    
</div> 
        </article>
        
            <div class="post__comments content-card" id="comment">
                
    <h4>Comments</h4>
    
    <div id="disqus_thread">Unable to load Disqus, please make sure your network can access.</div>

    
    
    
    
    
    
    
    


            </div>
        
    </div>


</main>

            <footer class="footer">
    


    
     
 

 
    
        
        <p class="footer-copyright">
            Copyright&nbsp;©&nbsp;2020&nbsp;<a href="/">Justin</a>
        </p>
    
    
    <p>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme - <a href="https://github.com/ChrAlpha/hexo-theme-cards" target="_blank">Cards</a></p>
</footer>

        </div>
        
    <script defer src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.1.0/dist/lazyload.min.js"></script>
    <script>
        window.lazyLoadOptions = {
            elements_selector: ".lazyload",
            threshold: 0
        };
    </script>
 

 

 

 

  



 


    


 

 
    <script defer src="/js/b2t.js"></script>





    
    <script>
        function loadComment() {
            window.disqus_config = function () {
                this.page.url = 'http://yoursite.com/2020/08/28/opencv/opencv5/';
                this.page.identifier = '2020/08/28/opencv/opencv5/';
            };
            (function(){
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + 'https-justin900429-github-io' + '.disqus.com/embed.js';
                (document.head || document.body).appendChild(dsq);
            })();
        }
    
        var runningOnBrowser = typeof window !== "undefined";
        var isBot = runningOnBrowser && !("onscroll" in window) || typeof navigator !== "undefined" && /(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);
        var supportsIntersectionObserver = runningOnBrowser && "IntersectionObserver" in window;
    
        setTimeout(function () {
            if (!isBot && supportsIntersectionObserver) {
                var comment_observer = new IntersectionObserver(function(entries) {
                    if (entries[0].isIntersecting) {
                        loadComment();
                        comment_observer.disconnect();
                    }
                }, { threshold: [0] });
                comment_observer.observe(document.getElementById('comment'));
            } else {
                loadComment();
            }
        }, 1);
    </script>


    
    
    

    
    
    
    
    
    
    
    
    

    



    </body>
</html>
